{% extends 'base.html' %}

{% load static %}

{% block title %} –í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã {% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/all_resipes.css' %}">
{% endblock %}

{% block content %}
<div class="filters-container" style="margin-bottom: 20px;">
    <form method="get" class="filters-form">
        <div class="filter-item">
            <label for="time_min">–í—Ä–µ–º—è –æ—Ç:</label>
            <input type="number" id="time_min" name="time_min" value="{{ request.GET.time_min }}">
        </div>

        <div class="filter-item">
            <label for="time_max">–í—Ä–µ–º—è –¥–æ:</label>
            <input type="number" id="time_max" name="time_max" value="{{ request.GET.time_max }}">
        </div>

        <div class="filter-item">
            <label for="ingredients_count">–û–¢ –ö–æ–ª-–≤–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤:</label>
            <input type="number" id="ingredients_count" name="ingredients_count" value="{{ request.GET.ingredients_count }}">
        </div>

        <div class="filter-item">
            <label for="order">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
            <select id="order" name="order">
                <option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                <option value="asc" {% if request.GET.order == 'asc' %}selected{% endif %}>–ê‚Äì–Ø</option>
                <option value="desc" {% if request.GET.order == 'desc' %}selected{% endif %}>–Ø‚Äì–ê</option>
            </select>
        </div>

        <button type="submit" class="btn btn-secondary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
    </form>
</div>

<div class="all-recipes-container">
    <h1>–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã</h1>
    
    {% if recipes %}
        <div class="recipes-grid">
            {% for recipe in recipes %}
            <div class="recipe-card">
                {% if recipe.image %}
                    <img src="{{ recipe.image.url }}" alt="{{ recipe.title }}" class="recipe-image">
                {% else %}
                    <div class="recipe-image-placeholder">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>
                {% endif %}
                
                <div class="recipe-content">
                    <h3 class="recipe-title">{{ recipe.title }}</h3>
                    <p class="recipe-description">{{ recipe.description|truncatewords:20 }}</p>
                    
                    <div class="recipe-meta">
                        <span class="cooking-time">‚è± {{ recipe.cooking_time }} –º–∏–Ω.</span>
                        <span class="difficulty">üìä {{ recipe.get_difficulty_display }}</span>
                    </div>
                    
                    <div class="recipe-ingredients">
                        <strong>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</strong>
                        <ul>
                            {% for ingredient in recipe.ingredients.all|slice:":3" %}
                                <li>{{ ingredient.name }}</li>
                            {% endfor %}
                            {% if recipe.ingredients.count > 3 %}
                                <li>... –∏ –µ—â–µ {{ recipe.ingredients.count|add:"-3" }}</li>
                            {% endif %}
                        </ul>
                    </div>
                    
                    <a href="{% url 'recipe_detail' recipe.id %}" class="btn btn-primary">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ—Ü–µ–ø—Ç</a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-recipes">
            <p>–†–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.</p>
        </div>
    {% endif %}
</div>
{% endblock %}